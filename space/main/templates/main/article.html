{% extends 'main/base.html' %}
{% load static %}

{% block body %}
    <!-- -----  Main Start  ----- -->
    <main>
        <!-- Articles START -->
        <div class="article">
            <span class="article-date">{{ article.created }}</span>
            <span class="article-reading-time">Reading time ~ {{ article.reading }} min.</span>
            <h2 class="article-title">{{ article.title }}</h2>
            {{ article.content|safe }}
            <div class="article-bottom">
				<span class="blog-main-post-card-bottom-comment">
					<i class="bi bi-chat"></i>
					<span>1337</span>
				</span>
                <span class="{{ article.slug }} fav_mark blog-main-post-card-bottom-favourite">
					<i class="bi bi-bookmark"></i>
					<span>add to favourite</span>
				</span>
                <span class="blog-main-post-card-bottom-rating">
					<i class="{{ article.slug }} bi bi-chevron-down rating-down"></i>
					<strong class="{{ article.slug }} rating"> {{ article.rating }} </strong>
					<i class="{{ article.slug }} bi bi-chevron-up rating-up"></i>
				</span>
                <span class="blog-main-post-card-bottom-tags">
					Tags:
                    {% for tag in article.tags.all %}
                        <span>#{{ tag.name }}</span>
                    {% endfor %}
				</span>
            </div>
        </div>
        <!-- Articles END -->

        <!-- Comments START -->
        <div id="block_comments">
            <div id="section_add">
                <h3> Add comment</h3>
                <form method="post" action="{% url 'article_form' %}" name="add_comm_form">
                    {% csrf_token %}
                    <p>
                        {{ form.nickname.label }}
                        {{ form.nickname }}
                    </p>
                    <p>
                        {{ form.content.label }}
                        {{ form.content }}
                    </p>
                    {{ form.article_slug.as_hidden }}
                    <button class="btn btn-primary" type="submit">Post</button>
                    <script>
                        var hidden_slug_field = document.getElementById("id_article_slug");
                        hidden_slug_field.value = "{{ article.slug }}";
                    </script>
                </form>
            </div>

            <div id="section_view">
                <h3> Comments ({{ comments_queryset.count }}) </h3>
                {% for comment in comments_queryset %}
                    <div style="background-color: var(--secondary); margin: 16px;">
                        <span> {{ comment.nickname }}</span>
                        <span> {{ comment.created }}</span>
                        <p> {{ comment.content }}</p>
                    </div>
                {% endfor %}
            </div>
        </div>
        <!-- Comments END -->
    </main>

    <script src="{% static 'main/js/blog_post_cookies.js' %}"></script>
    <!-- -----   Main End   ----- -->
{% endblock %}